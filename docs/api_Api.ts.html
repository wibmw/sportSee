<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: api/Api.ts</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: api/Api.ts</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import axios, { AxiosResponse, AxiosRequestConfig } from 'axios'
import { useNavigate } from 'react-router-dom'
import { useEffect, useState } from 'react'
import { activity, average, performances, user } from './mockedDatas'

/**
 * Get and returns datas from the back-end or the mocked datas
 *
 * @module
 * @param {string} id User id
 * @param {string} url Back-end path for url
 * @param {string} dataParam Data de get from the returned datas
 * @returns {*} data
 */
export const getDatas = (id: string, url: string, dataParam: string) => {
  const conf: AxiosRequestConfig = {},
    [data, setData] = useState&lt;any>(),
    [isError, setIsError] = useState(false),
    navigate = useNavigate(),
    client = axios.create({
      baseURL: 'http://localhost:3500/user/',
    })

  conf.validateStatus = (status: number) => {
    return (status >= 200 &amp;&amp; status &lt; 300) || status == 404
  }

  // Fetch data from the API
  useEffect(() => {
    /**
     * Fetch from API datas
     *
     * @method
     * @async
     * @returns {*}
     */
    const fetchData = async () => {
      const validIds = ['12', '18']
      try {
        client
          .get&lt;[]>(id + url, conf)
          .then((res: AxiosResponse) => {
            if (((res.status >= 200 &amp;&amp; res.status &lt; 300) || isError === false) &amp;&amp; validIds.includes(id))
              setData(res.data.data[dataParam])
            else {
              setIsError(true)
              console.error('404 : No user found !')
              navigate('./error', { state: { error: 'Aucun utilisteur trouvé !' } })
            }
          })
          .catch((error) => {
            setIsError(true)
            setData(getMockedDatas())
            console.log('INFO: Utilisation des données locales, car l\'API distante n\'est pas disponible. \n' + error)
          })
      } catch (error) {
        setIsError(true)
      }
    }
    fetchData()
  }, [])

  /**
   * Fetch from local datas
   *
   * @method
   * @returns {*}
   */
  const getMockedDatas = () => {
    let datas
    if (url === '/average-sessions') datas = average.data
    else if (url === '/activity') datas = activity.data
    else if (url === '/performance') datas = performances.data
    else datas = user.data

    return datas &amp;&amp; datas.filter((data) => data?.id?.toString() === id || data?.userId?.toString() === id)[0][dataParam]
  }

  return data &amp;&amp; data
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="api_Api.module_ts.html">ts</a></li><li><a href="components_charts_activityItems_Activity.module_tsx.html">tsx</a></li><li><a href="components_charts_activityItems_ActivityItem.module_tsx.html">tsx</a></li><li><a href="components_charts_barChart_BarChart.module_tsx.html">tsx</a></li><li><a href="components_charts_lineChart_LineChart.module_tsx.html">tsx</a></li><li><a href="components_charts_radialChart_RadialChart.module_tsx.html">tsx</a></li><li><a href="components_charts_spiderChart_SpiderChart.module_tsx.html">tsx</a></li><li><a href="components_static_header_Header.module_tsx.html">tsx</a></li><li><a href="components_static_sideBar_Sidebar.module_tsx.html">tsx</a></li><li><a href="components_static_topMessage_TopMessage.module_tsx.html">tsx</a></li><li><a href="pages_error_Error.module_tsx.html">tsx</a></li><li><a href="pages_home_Home.module_tsx.html">tsx</a></li><li><a href="utils_d3Tools.module_ts.html">ts</a></li></ul><h3>Classes</h3><ul><li><a href="global.html#Service">Service</a></li><li><a href="Service_Service.html">Service</a></li><li><a href="global.html#User">User</a></li><li><a href="User_User.html">User</a></li></ul><h3>Global</h3><ul><li><a href="global.html#svgRadius">svgRadius</a></li><li><a href="global.html#vh">vh</a></li><li><a href="global.html#vw">vw</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.11</a> on Mon Oct 17 2022 16:16:53 GMT+0200 (Central European Summer Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
